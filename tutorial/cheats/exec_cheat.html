<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://gmic.eu/style.css">
    <title>exec_cheat</title>
    <script src="../jquery-3.5.1.min.js"></script>
    <script>var jQuery_3_5_1 = $.noConflict(true);</script>
  </head>

  <body>
    <!--#include file="header1.html" -->

    <div class="section_title"><p>Tutorial</p></div><div class="section_content">

<!-- begin_content -->

<br/>
<table class="gmd_hvtable">
<tr><td><a href="cheatsheet.html" target="_blank">Cheat Home</a></td><td><a href="custom_cheat.html" target="_blank">Custom Cheat</a></td><td><a href="display_cheat.html" target="_blank">Display Cheat</a></td><td><a href="debug_cheat.html" target="_blank">Debug Cheat</a></td><td><a href="array_cheat.html" target="_blank">Array Cheat</a></td><td><a href="subs_cheat.html" target="_blank">Substitution Cheat</a></td></tr>
<tr><td><span class="gmd_bold_a">Execute Cheat</span></td><td>                    </td><td>                    </td><td>                    </td><td>                    </td><td>                    </td></tr>
</table>
<a name="cheat_7_execute_a_subprocess_from_g_mic"></a><div class="gmd_subsubsection">Cheat #7: Execute a Subprocess from G&apos;MIC</div>
<a name="tl_dr"></a><div class="gmd_subsubsubsection">TL;DR</div>
<table class="gmd_vtable">
<tr><td><img class="gmd_image" src="images/amp.png" alt="amp" title="amp"/><br/>
                  <a href="#svgexample">French Flag Ampersand</a></td><td>You want to run a script or program outside of your G&apos;MIC script and harvest its output.<br/>
<br/>
For that use the <span class="gmd_page_link"><a href="https://gmic.eu/reference/exec.html">exec</a></span> command; shortcut: <span class="gmd_page_link"><a href="x.html">x</a></span>.<br/>
<br/>
<span class="gmd_monospace">exec&nbsp;_is_verbose={ 0 or 1 },&quot;command&quot;</span><br/>
<br/>
 1.  The first argument, <span class="gmd_monospace">is_verbose</span>, defaults to <span class="gmd_monospace">1</span>. Useful if you want to process whatever the external command writes to its standard output. But perhaps the command writes to a file. Then set <span class="gmd_monospace">is_verbose</span> to zero and avoid string fetches you won&apos;t be using.<br/>
 2.  The second argument invokes the script or program you wish to run outside of G&apos;MIC. Write it, and its arguments, as if at a shell prompt.</td></tr>
</table>
<br/>
The example uses this Python script:<br/>
<div class="gmd_center">
<div class="gmd_code_block">&nbsp;$&nbsp;svghelper.py&nbsp;-h<br/>
usage:&nbsp;svghelper.py&nbsp;[-h]&nbsp;[-d&nbsp;DENSITY]&nbsp;[-o&nbsp;OUTPUT]&nbsp;[-n]&nbsp;fname<br/>
<br/>
Plot&nbsp;points&nbsp;from&nbsp;SVG&nbsp;Path.<br/>
<br/>
positional&nbsp;arguments:<br/>
&nbsp;&nbsp;fname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Strutured&nbsp;Vector&nbsp;Graphics&nbsp;(SVG)&nbsp;file<br/>
<br/>
options:<br/>
&nbsp;&nbsp;-h,&nbsp;--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show&nbsp;this&nbsp;help&nbsp;message&nbsp;and&nbsp;exit<br/>
&nbsp;&nbsp;-d&nbsp;DENSITY,&nbsp;--density&nbsp;DENSITY<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;point&nbsp;quantity&nbsp;as&nbsp;powers&nbsp;of&nbsp;two;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 -&gt; 2^4 -&gt; 16.&nbsp;Larger -&gt; denser.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;10&nbsp;(1024)<br/>
&nbsp;&nbsp;-o&nbsp;OUTPUT,&nbsp;--output&nbsp;OUTPUT<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Text&nbsp;file&nbsp;for&nbsp;output&nbsp;plots.<br/>
&nbsp;&nbsp;-n,&nbsp;--normalize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Normalize&nbsp;plots.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1)&nbsp;Center&nbsp;of&nbsp;gravity&nbsp;maps&nbsp;to&nbsp;origin.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2)&nbsp;Scaling&nbsp;of&nbsp;largest&nbsp;distance&nbsp;to&nbsp;1,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3)&nbsp;Preserves&nbsp;aspect&nbsp;ratio.</div>
( Download <a href="scripts/svghelper.py" target="_blank">svghelper.py</a> )
</div>The python script harnesses Mathandy&apos;s <a href="https://github.com/mathandy/svgpathtools#svgpathtools" target="_blank">svgpathtools</a> to parse Structured Vector Graphics files. The script digitizes the path of the first graphical object listed in the SVG file. While such a retrival serves our limited purposes, the script does not fully exercise <span class="gmd_monospace">svgpathtool&apos;s</span> considerable capabilities — among which can be selections based on labeled paths. For the path-selection-impaired script <span class="gmd_monospace">svghelper.py</span>, create an SVG document with just <span class="gmd_italic_u">one</span> path. &nbsp;<br/>
<br/>
<a name="svgexample"></a>
<a name="example_fetch_svg_path"></a><div class="gmd_subsubsubsection">Example: Fetch SVG Path</div>
<div class="gmd_code_block">svgtoimg:&nbsp;-check&nbsp;${1=10}&gt;0&quot;&nbsp;&amp;&amp;&nbsp;&quot;isbool(${2=1})&quot;&nbsp;&amp;&amp;&nbsp;&quot;isfile([&apos;$3&apos;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;dens=$1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;norm=$2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ifile=$3<br/>
&nbsp;&nbsp;&nbsp;&nbsp;preamble=&quot;Read&nbsp;SVG&nbsp;path&nbsp;from&nbsp;&quot;$ifile<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Normalize&nbsp;plot&nbsp;points?<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-if&nbsp;$norm<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nflg=&apos;--normalize&apos;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo[^-1]&nbsp;$preamble&quot;,&nbsp;normalize&nbsp;and&nbsp;digitize&nbsp;path&nbsp;to&nbsp;&quot;{2^$dens}&quot;&nbsp;plots.&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nflg=&apos;&apos;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo[^-1]&nbsp;$preamble&quot;&nbsp;and&nbsp;digitize&nbsp;path&nbsp;to&nbsp;&quot;{2^$dens}&quot;&nbsp;plots.&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-fi<br/>
&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;name&nbsp;of&nbsp;a&nbsp;temporary&nbsp;file&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;will&nbsp;live&nbsp;in&nbsp;the&nbsp;/tmp&nbsp;diretory.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-filename_rand<br/>
&nbsp;&nbsp;&nbsp;&nbsp;fn=${}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Command&nbsp;to&nbsp;execute:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;cmd=&quot;python&nbsp;scripts/svghelper.py&nbsp;--density&nbsp;&quot;$dens&quot;&nbsp;&quot;$nflg&quot;&nbsp;--output&nbsp;&quot;$fn&quot;&nbsp;&quot;$ifile<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Invoke&nbsp;script<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-exec&nbsp;1,$cmd<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stdo=${}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Did&nbsp;the&nbsp;subprocess&nbsp;create&nbsp;an&nbsp;output?<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-if&nbsp;isfile([&apos;$fn&apos;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-input_csv&nbsp;$fn,0<br/>
	-exec&nbsp;0,&quot;rm&nbsp;&quot;$fn<br/>
	-name.&nbsp;svgplots<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo[^-1]&nbsp;&quot;stdout dump: &quot;$stdo<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;&quot;Could&nbsp;not&nbsp;find:&nbsp;&quot;$fn<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-fi<br/>
——————————<br/>
<br/>
$&nbsp;gmic&nbsp;scripts/svgtoimg.gmic&nbsp;-v&nbsp;+&nbsp;-svgtoimg&nbsp;4,1,images/ampersand_circ.svg&nbsp;-v&nbsp;-<br/>
[gmic]-0./&nbsp;Start&nbsp;G&apos;MIC&nbsp;interpreter.<br/>
[gmic]-0./&nbsp;Input&nbsp;custom&nbsp;command&nbsp;file&nbsp;&apos;scripts/svgtoimg.gmic&apos;&nbsp;(2&nbsp;new,&nbsp;total:&nbsp;4564).<br/>
[gmic]-0./&nbsp;Increment&nbsp;verbosity&nbsp;level&nbsp;(set&nbsp;to&nbsp;2).<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;dens=4&apos;.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;norm=1&apos;.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;ifile=images/ampersand_circ.svg&apos;.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;preamble=Read&nbsp;SVG&nbsp;path&nbsp;from&nbsp;&apos;.<br/>
[gmic]-0./svgtoimg/*if/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;nflg=&apos;--normalize&apos;&apos;.<br/>
[gmic]-0./svgtoimg/&nbsp;Read&nbsp;SVG&nbsp;path&nbsp;from&nbsp;images/ampersand_circ.svg,&nbsp;normalize&nbsp;and&nbsp;digitize&nbsp;path&nbsp;to&nbsp;16&nbsp;plots.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;fn=/tmp/gmic17060476126&apos;.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;cmd=python&nbsp;scripts/svghelper.py&nbsp;--density&nbsp;4&nbsp;&apos;--normalize&apos;&nbsp;--output&nbsp;/tmp/gm(...).<br/>
[gmic]-0./svgtoimg/&nbsp;Execute&nbsp;external&nbsp;command&nbsp;&apos;python&nbsp;scripts/svghelper.py&nbsp;--densit(...)17060476126&nbsp;images/ampersand_circ.svg&apos;&nbsp;in&nbsp;verbose&nbsp;mode.<br/>
[gmic]-0./svgtoimg/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;stdo=0&apos;.<br/>
[gmic]-0./svgtoimg/*if/&nbsp;Input&nbsp;number&nbsp;array&nbsp;from&nbsp;file&nbsp;&apos;/tmp/gmic17060476126&apos;.<br/>
[gmic]-1./svgtoimg/*if/&nbsp;Execute&nbsp;external&nbsp;command&nbsp;&apos;rm&nbsp;/tmp/gmic17060476126&apos;&nbsp;.<br/>
[gmic]-1./svgtoimg/*if/&nbsp;Set&nbsp;name&nbsp;of&nbsp;image&nbsp;[0]&nbsp;to&nbsp;&apos;svgplots&apos;.<br/>
[gmic]-1./&nbsp;Decrement&nbsp;verbosity&nbsp;level&nbsp;(set&nbsp;to&nbsp;1).<br/>
[gmic]-1./&nbsp;Display&nbsp;image&nbsp;[0]&nbsp;=&nbsp;&apos;svgplots&apos;.<br/>
[0]&nbsp;=&nbsp;&apos;svgplots&apos;:<br/>
&nbsp;&nbsp;size&nbsp;=&nbsp;(2,16,1,1)&nbsp;[128&nbsp;b&nbsp;of&nbsp;float32].<br/>
&nbsp;&nbsp;data&nbsp;=&nbsp;(-0.306328,0.0860442;-0.0848769,0.363683;-0.29221,0.177343;-0.127902,0.00188423;-0.200789,0.0523709;-0.144242,-0.305296;(...),0.349561,0.345194;0.389299,0.368731;0.31905,0.00283116;0.156633,-0.349672;-0.276443,-0.332615;-0.306328,0.0860442).<br/>
&nbsp;&nbsp;min&nbsp;=&nbsp;-0.349672,&nbsp;max&nbsp;=&nbsp;0.389299,&nbsp;mean&nbsp;=&nbsp;-1.2551e-09,&nbsp;std&nbsp;=&nbsp;0.241429,&nbsp;coords_min&nbsp;=&nbsp;(1,13,0,0),&nbsp;coords_max&nbsp;=&nbsp;(0,11,0,0).</div>
<div class="gmd_center">
( Download <a href="scripts/svgtoimg.gmic" target="_blank">svgtoimg.gmic</a> )
</div><span class="gmd_monospace">svgtoimg</span> produces a 2 × <span class="gmd_italic_u">n</span> image on the list containing <span class="gmd_italic_u">n</span> plot points.<br/>
<br/>
<div class="gmd_center">
<img class="gmd_image" src="img/images_digitizedpath_jpg_r2dx_50.png" alt="images/digitizedpath.jpg r2dx 50%"/>
</div><br/>
<table class="gmd_vtable">
<tr><td> 1.  </td><td><span class="gmd_monospace">svgtoimg</span> assembles <span class="gmd_monospace">cmd</span> from bits of unvarying text and custom command arguments. If this assembly is hard to follow, spend some time with G&apos;MIC&apos;s <a href="subs_cheat.html" target="_blank">Substitution Rules</a>. When defining custom G&apos;MIC commands, such as <span class="gmd_monospace">svgtoimg</span>, we have <span class="gmd_monospace">$-expressions</span> at our disposal; these map custom command arguments to numeric keys: <span class="gmd_monospace">$0,&nbsp;$1,&nbsp;$2…</span>. <span class="gmd_monospace">$0</span> substitutes for name used to invoke the script; the remaining pre-defined numeric substitutions represent arguments given to the custom command. In addition to these, there are other pre-defined <span class="gmd_monospace">$-expressions</span> that furnish additional metrics about the custom command&apos;s arguments. Here, our game is one of transferring custom command arguments to their python script counterparts; <span class="gmd_italic_u">sic transit</span> the first half of <span class="gmd_monospace">svgtoimg</span>. &nbsp;</td></tr>
<tr><td> 2.  </td><td>The detection of a successful run of the python script hinges on an actual creation of some file; its name comes from <span class="gmd_monospace">-filename_rand</span>. The litany of what can go wrong does not end with that file&apos;s creation. The python script might still hiccup and produce an empty file or one filled with random noise. But the absence of the expected file in its expected location is a clear show-stopper.<br/>
<br/>
A status check is viable too: <span class="gmd_monospace">${}</span> is a predefined variable reserved for return values of custom commands. These may opt not to return anything; <span class="gmd_monospace">${}</span> then is an empty string. However, python scripts launched via <span class="gmd_monospace">exec</span>, do signal parent processes with return status values; successes are represented by zero values and anything else signals a failure of some sort. G&apos;MIC acquires this return value from the python interpreter when the subprocess exits.<br/>
<br/>
The compulsively industrious could set out to determine which disaster might have befallen the python script; the return status is an unsigned integer consisting of single-bit error flags. One could then assiduously map these flag bits to apt error messages. We are content to bail on any non-zero return value, issuing a generic message as we go. &nbsp;</td></tr>
<tr><td> 3.  </td><td>If we find that we have a file, we might hazard the guess that it is in good health. Having run the python script by hand outside of G&apos;MIC, we know that correct output consists of numerical text strings of floats: the x-coordinate of a plot, a comma (<span class="gmd_monospace">,</span>) the y-coordinate of the same plot, then a newline — and this pattern repeats, plot-by-plot, until the end-of-file marker. This is a comma-separated value file; it could be read into G&apos;MIC by <span class="gmd_page_link"><a href="https://gmic.eu/reference/input_csv.html">input_csv</a></span>, which takes as arguments a file of comma separated values, and a flag guiding how to interpret its content: <span class="gmd_monospace">0</span> means we wish <span class="gmd_monospace">input_csv</span> will translate numerical text into actual floating point numerals; <span class="gmd_monospace">1</span> indicates that we prefer text input, untranslated. In either case, <span class="gmd_monospace">input_csv</span> places an image on the list: 2 × <span class="gmd_italic_u">n</span> for <span class="gmd_italic_u">n</span>, the number of coordinate pairs found in the file.</td></tr>
</table>
<br/>
Perhaps you want to plot this data. Then consider <span class="gmd_monospace">imgplot</span>:<br/>
<br/>
<a name="pltexample"></a>
<a name="example_plot_points"></a><div class="gmd_subsubsection">Example: Plot Points</div>
<div class="gmd_code_block">imgplot:&nbsp;-check&nbsp;${is_image_arg\&nbsp;$1}&quot;&nbsp;&amp;&amp;&nbsp;&quot;${2=1}&gt;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-echo[^-1]&nbsp;&quot;Plot&nbsp;on&nbsp;selected&nbsp;images&nbsp;data&nbsp;from&nbsp;image$?&nbsp;with&nbsp;scaling&nbsp;${2}&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale=$2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-pass$1&nbsp;1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach[^-1]&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-name.&nbsp;canvas<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-pass[-1]&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-name.&nbsp;svgplots<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-permute[svgplots]&nbsp;cyzx<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-fill[svgplots]&nbsp;&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sw=min(w#$canvas,h#$canvas)/2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id=eye(3);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[0]=$scale*sw;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[2]=sw;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[4]=-$scale*sw;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id[5]=sw<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(id*[I(x,y),1])[0,2]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-permute[svgplots]&nbsp;cyzx<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-eval&nbsp;&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV=crop(#$svgplots);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;polygon(#$canvas,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-int(size(PV)/2),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xffffffff,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-remove[svgplots]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-remove.<br/>
——————————<br/>
$&nbsp;gmic&nbsp;scripts/svgtoimg.gmic&nbsp;-svgtoimg&nbsp;6,1,images/ampersand_circ.svg&nbsp;-name.&nbsp;plots&nbsp;512,512,1,1&nbsp;-name.&nbsp;canvas&nbsp;-v&nbsp;+&nbsp;imgplot[canvas]&nbsp;[plots],1.75<br/>
[gmic]-0./&nbsp;Start&nbsp;G&apos;MIC&nbsp;interpreter.<br/>
[gmic]-0./&nbsp;Input&nbsp;custom&nbsp;command&nbsp;file&nbsp;&apos;scripts/svgtoimg.gmic&apos;&nbsp;(2&nbsp;new,&nbsp;total:&nbsp;4564).<br/>
[gmic]-0./svgtoimg/&nbsp;Read&nbsp;SVG&nbsp;path&nbsp;from&nbsp;images/ampersand_circ.svg,&nbsp;normalize&nbsp;and&nbsp;digitize&nbsp;path&nbsp;to&nbsp;64&nbsp;plots.<br/>
[gmic]-1./&nbsp;Set&nbsp;name&nbsp;of&nbsp;image&nbsp;[0]&nbsp;to&nbsp;&apos;plots&apos;.<br/>
[gmic]-1./&nbsp;Input&nbsp;black&nbsp;image&nbsp;at&nbsp;position&nbsp;1&nbsp;(1&nbsp;image&nbsp;512x512x1x1).<br/>
[gmic]-2./&nbsp;Set&nbsp;name&nbsp;of&nbsp;image&nbsp;[1]&nbsp;to&nbsp;&apos;canvas&apos;.<br/>
[gmic]-2./&nbsp;Increment&nbsp;verbosity&nbsp;level&nbsp;(set&nbsp;to&nbsp;2).<br/>
[gmic]-1./&nbsp;Plot&nbsp;on&nbsp;selected&nbsp;images&nbsp;data&nbsp;from&nbsp;image&nbsp;[1]&nbsp;with&nbsp;scaling&nbsp;1.75<br/>
[gmic]-1./imgplot/&nbsp;Set&nbsp;local&nbsp;variable&nbsp;&apos;scale=1.75&apos;.<br/>
[gmic]-1./imgplot/&nbsp;Insert&nbsp;image&nbsp;[0]&nbsp;from&nbsp;parent&nbsp;context&nbsp;in&nbsp;shared&nbsp;state.<br/>
[gmic]-1./imgplot/*foreach/&nbsp;Set&nbsp;name&nbsp;of&nbsp;image&nbsp;[0]&nbsp;to&nbsp;&apos;canvas&apos;.<br/>
[gmic]-1./imgplot/*foreach/&nbsp;Insert&nbsp;image&nbsp;[1]&nbsp;from&nbsp;parent&nbsp;context&nbsp;in&nbsp;non-shared&nbsp;state.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Set&nbsp;name&nbsp;of&nbsp;image&nbsp;[1]&nbsp;to&nbsp;&apos;svgplots&apos;.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Permute&nbsp;axes&nbsp;of&nbsp;image&nbsp;[1],&nbsp;with&nbsp;permutation&nbsp;&apos;cyzx&apos;.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Fill&nbsp;image&nbsp;[1]&nbsp;with&nbsp;expression&nbsp;&apos;&nbsp;begin(&nbsp;sw=min(w#$canvas,h#$canvas)/2;(...)sw;&nbsp;id[5]=sw&nbsp;);&nbsp;(id*[I(x,y),1])[0,2]&nbsp;&apos;.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Permute&nbsp;axes&nbsp;of&nbsp;image&nbsp;[1],&nbsp;with&nbsp;permutation&nbsp;&apos;cyzx&apos;.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Evaluate&nbsp;expression&nbsp;&apos;&nbsp;PV=crop(#$svgplots);&nbsp;polygon(#$canvas(...)ize(PV)/2),&nbsp;PV,&nbsp;1,&nbsp;0xffffffff,&nbsp;255&nbsp;)&nbsp;&apos;&nbsp;and&nbsp;assign&nbsp;it&nbsp;to&nbsp;status.<br/>
[gmic]-2./imgplot/*foreach/&nbsp;Remove&nbsp;image&nbsp;[1]&nbsp;(1&nbsp;image&nbsp;left).<br/>
[gmic]-2./imgplot/&nbsp;Remove&nbsp;image&nbsp;[1]&nbsp;(1&nbsp;image&nbsp;left).<br/>
[gmic]-2./&nbsp;Display&nbsp;images&nbsp;[0,1]&nbsp;=&nbsp;&apos;plots,&nbsp;canvas&apos;.<br/>
[0]&nbsp;=&nbsp;&apos;plots&apos;:<br/>
&nbsp;&nbsp;size&nbsp;=&nbsp;(2,64,1,1)&nbsp;[512&nbsp;b&nbsp;of&nbsp;float32].<br/>
&nbsp;&nbsp;data&nbsp;=&nbsp;(-0.276844,0.0719817;-0.306167,0.161578;-0.275229,0.249145;-0.197808,0.309231;-0.1046,0.316088;-0.0414858,0.255473;(...),-0.189243,-0.331823;-0.265615,-0.274045;-0.31687,-0.193355;-0.331768,-0.100003;-0.308596,-0.00714994;-0.276844,0.0719817).<br/>
&nbsp;&nbsp;min&nbsp;=&nbsp;-0.358714,&nbsp;max&nbsp;=&nbsp;0.3991,&nbsp;mean&nbsp;=&nbsp;-3.13776e-10,&nbsp;std&nbsp;=&nbsp;0.202658,&nbsp;coords_min&nbsp;=&nbsp;(1,57,0,0),&nbsp;coords_max&nbsp;=&nbsp;(0,48,0,0).<br/>
[1]&nbsp;=&nbsp;&apos;canvas&apos;:<br/>
&nbsp;&nbsp;size&nbsp;=&nbsp;(512,512,1,1)&nbsp;[1024&nbsp;Kio&nbsp;of&nbsp;float32].<br/>
&nbsp;&nbsp;data&nbsp;=&nbsp;(0,0,0,0,0,0,0,0,0,0,0,0,(...),0,0,0,0,0,0,0,0,0,0,0,0).<br/>
&nbsp;&nbsp;min&nbsp;=&nbsp;0,&nbsp;max&nbsp;=&nbsp;255,&nbsp;mean&nbsp;=&nbsp;2.26261,&nbsp;std&nbsp;=&nbsp;23.9134,&nbsp;coords_min&nbsp;=&nbsp;(0,0,0,0),&nbsp;coords_max&nbsp;=&nbsp;(373,111,0,0).</div>
<div class="gmd_center">
<img class="gmd_image" src="images/coarseamper.png" alt="CoarseAmpersand" title="CoarseAmpersand"/><br/>
Coarse Ampersand: 64 plot points
</div>
<table class="gmd_vtable">
<tr><td> 1.  </td><td><a href="https://gmic.eu/tutorial/from_wheelies_arabesques.html#threewheelieredrawn">Drawing wheelies</a> also makes use of this <a href="https://gmic.eu/reference/mathematical_expressions.html#top">Mathematical expression</a> based plotter. <span class="gmd_page_link"><a href="https://gmic.eu/reference/fill.html">fill</a></span> takes a <a href="https://gmic.eu/tutorial/fill.html#math_expressions">pixel processor</a> to scale and translate the normalized data in <span class="gmd_monospace">svgplots</span> to the specific size of selected images; <span class="gmd_monospace">$scale</span> furnishes a mechanism to further resize this transform. The pixel processor composes the transformation matrix <span class="gmd_monospace">id</span> in a <span class="gmd_monospace">begin()</span> statement; this statement executes its argument once before the start of pixel processing. During pixel processing, it applies matrix <span class="gmd_monospace">id</span> to each plot point in <span class="gmd_monospace">svgplots</span>, scaling and translating these to fit the currently selected image. &nbsp;A second mathematical expression, this the argument to <span class="gmd_page_link"><a href="https://gmic.eu/reference/eval.html">eval</a></span>, plots the entire data set by way of the mathematical expression <span class="gmd_monospace">polygon()</span>. Here, the image <span class="gmd_monospace">svgplots</span> served as a data exchange mechanism between the two math expressions, which are otherwise wholly isolated from one another. </td></tr>
</table>
<hr/>
Updated: May 08 2023 22:37 UTC Commit: 8df222c0f3b2b56953bae64f8eda7c4ae15d0993 <br/>


<!-- end_content -->

    </div><div class="section_end"></div>

    <!--#include file="footer.html" -->
  </body>